# åŒ¯å‡ºåŠŸèƒ½æ“´å±•é–‹ç™¼è¦åŠƒ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æª”ç‚ºå€™ä½ç³»çµ±æ–°å¢å…©å€‹åŒ¯å‡ºåŠŸèƒ½çš„å®Œæ•´é–‹ç™¼è¦åŠƒï¼š
1. **å®¢æˆ¶è³‡æ–™è¡¨æ ¼ç¯„æœ¬ Excel åŒ¯å‡º** - å¸¶åˆä½µå„²å­˜æ ¼çš„æ¨™æº–è¡¨æ ¼æ ¼å¼
2. **ä¿®ç„å®®å•äº‹å–® PDF ç”Ÿæˆ** - A4æ©«å¼é é¢ï¼Œé›™A5ç›´å¼å•äº‹å–®

å…©å€‹åŠŸèƒ½éƒ½åŒ…å«**é è¦½æ©Ÿåˆ¶**ï¼Œæ–°é–‹ç¶²é é è¦½å¾Œç¢ºèªä¸‹è¼‰ã€‚

## ğŸ¯ åŠŸèƒ½éœ€æ±‚ç¸½çµ

### è³‡æ–™ç¯©é¸ç¯„åœ
- åªåŒ¯å‡ºç‹€æ…‹ç‚º `waiting` å’Œ `processing` çš„å®¢æˆ¶
- åŒ…å«å®¢æˆ¶çš„æ‰€æœ‰å®¶äºº

### è¾²æ›†æ—¥æœŸè™•ç†
- å„ªå…ˆé¡¯ç¤ºè¾²æ›†æ—¥æœŸï¼Œæ ¼å¼ï¼š`æ°‘åœ‹XXå¹´XæœˆXæ—¥`
- è‹¥ç„¡è¾²æ›†æ—¥æœŸå‰‡ç•™ç©º

### æ“ä½œæµç¨‹
1. ç®¡ç†å“¡é»æ“Šã€ŒåŒ¯å‡ºè³‡æ–™ã€â†’ é¸æ“‡åŒ¯å‡ºé¡å‹
2. æ–°é–‹ç¶²é é¡¯ç¤ºé è¦½å…§å®¹
3. é è¦½é é¢æä¾›ä¸‹è¼‰æŒ‰éˆ•
4. ç¢ºèªå¾Œé»æ“Šä¸‹è¼‰

## ğŸ“Š åŠŸèƒ½ä¸€ï¼šå®¢æˆ¶è³‡æ–™è¡¨æ ¼ç¯„æœ¬ Excel

### è¡¨æ ¼æ¬„ä½çµæ§‹
```
å®Œæˆï½œåºè™Ÿï½œå§“åï½œäººæ•¸ï½œæ€§åˆ¥ï½œè¾²æ›†ç”Ÿæ—¥ï½œè™›æ­²ï½œåœ°å€ï½œé¡å‹ï½œè«®è©¢ä¸»é¡Œï½œå‚™è¨»
```

### åˆä½µå„²å­˜æ ¼é‚è¼¯
**éœ€è¦åˆä½µçš„æ¬„ä½**ï¼ˆä¸»å®¢æˆ¶+æ‰€æœ‰å®¶äººå‚ç›´åˆä½µï¼‰ï¼š
- `å®Œæˆ` - ç©ºç™½æ¬„ä½ä¾›æ‰‹å¯«
- `åºè™Ÿ` - å®¢æˆ¶çš„ queueNumber
- `äººæ•¸` - ä¸»å®¢æˆ¶ + å®¶äººç¸½æ•¸
- `è«®è©¢ä¸»é¡Œ` - ä¸»å®¢æˆ¶çš„è«®è©¢ä¸»é¡Œï¼ˆä¸­æ–‡åŒ–ï¼‰
- `å‚™è¨»` - ä¸»å®¢æˆ¶çš„å‚™è¨»

**ä¸åˆä½µçš„æ¬„ä½**ï¼ˆæ¯å€‹äººç¨ç«‹ï¼‰ï¼š
- `å§“å` - æ¯å€‹äººçš„å§“å
- `æ€§åˆ¥` - æ¯å€‹äººçš„æ€§åˆ¥ï¼ˆç”·/å¥³ï¼‰
- `è¾²æ›†ç”Ÿæ—¥` - æ¯å€‹äººçš„è¾²æ›†ç”Ÿæ—¥
- `è™›æ­²` - æ¯å€‹äººçš„è™›æ­²
- `åœ°å€` - æ¯å€‹äººçš„åœ°å€
- `é¡å‹` - æ¯å€‹äººçš„åœ°å€é¡å‹

### å®Œæ•´åˆä½µç¤ºä¾‹
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚å®Œæˆâ”‚åºè™Ÿâ”‚å§“åâ”‚äººæ•¸â”‚æ€§åˆ¥â”‚è¾²æ›†ç”Ÿæ—¥    â”‚è™›æ­²â”‚åœ°å€      â”‚é¡å‹â”‚è«®è©¢ä¸»é¡Œâ”‚å‚™è¨»â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
â”‚    â”‚  5 â”‚å¼µä¸‰â”‚ 4  â”‚ç”· â”‚æ°‘åœ‹80å¹´1æœˆâ”‚35æ­²â”‚å°åŒ—å¸‚... â”‚ä½å®¶â”‚èº«é«”ã€å®¶é‹â”‚    â”‚
â”‚    â”‚    â”œâ”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤        â”‚    â”‚
â”‚    â”‚    â”‚æå››â”‚    â”‚å¥³ â”‚æ°‘åœ‹82å¹´3æœˆâ”‚33æ­²â”‚å°åŒ—å¸‚... â”‚ä½å®¶â”‚        â”‚    â”‚
â”‚    â”‚    â”œâ”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤        â”‚    â”‚
â”‚    â”‚    â”‚ç‹äº”â”‚    â”‚ç”· â”‚æ°‘åœ‹110å¹´5æœˆâ”‚3æ­²â”‚å°åŒ—å¸‚... â”‚ä½å®¶â”‚        â”‚    â”‚
â”‚    â”‚    â”œâ”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤        â”‚    â”‚
â”‚    â”‚    â”‚å°æ˜â”‚    â”‚ç”· â”‚æ°‘åœ‹112å¹´8æœˆâ”‚1æ­²â”‚å°åŒ—å¸‚... â”‚ä½å®¶â”‚        â”‚    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

## ğŸ“„ åŠŸèƒ½äºŒï¼šä¿®ç„å®®å•äº‹å–® PDF

### PDF è¦æ ¼
- **é é¢æ ¼å¼**: A4 æ©«å¼ (297Ã—210mm)
- **å•äº‹å–®æ ¼å¼**: A5 ç›´å¼ (210Ã—148mm)
- **ä½ˆå±€**: æ¯é å…©å¼µå•äº‹å–®å·¦å³æ’åˆ—
- **è£åˆ‡ç·š**: ä¸­é–“ç•™ 2mm è™›ç·šä¾›è£åˆ‡

### å•äº‹å–®æ¬„ä½è¨­è¨ˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ä¿®ç„å®®ç„è«‹ç¤ºå–®             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚  åœ°å€ï¼š  â”‚             â”‚
â”‚   è«‹ç¤ºå…§å®¹   â”‚ (å®¢æˆ¶åœ°å€) â”‚    å§“å     â”‚
â”‚ (è«®è©¢ä¸»é¡Œ)   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ (å®¢æˆ¶å§“å)   â”‚
â”‚             â”‚         â”‚             â”‚
â”‚             â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚         â”‚    æ€§åˆ¥     â”‚
â”‚             â”‚         â”‚ (å®¢æˆ¶æ€§åˆ¥)   â”‚
â”‚             â”‚  å¹´  å¹´  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚    å¹´é½¡     â”‚
â”‚   é›»è©±ï¼š     â”‚  æœˆ  æœˆ  â”‚ (å®¢æˆ¶è™›æ­²)   â”‚
â”‚ (å®¢æˆ¶é›»è©±)   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚   è¾²æ›†å‡ºç”Ÿ   â”‚
â”‚   å¹´  æœˆ  æ—¥ â”‚  æ—¥  æ—¥  â”‚ å¹´ æœˆ æ—¥ æ™‚  â”‚
â”‚             â”‚         â”‚ (å®¢æˆ¶è¾²æ›†)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç·¨è™Ÿï¼š     â”‚  æ™‚  æ™‚  â”‚             â”‚
â”‚(å€™ä½è™Ÿç¢¼)    â”‚         â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è³‡æ–™å°æ‡‰
- **å§“å**: customer.name
- **æ€§åˆ¥**: ç”·/å¥³ (customer.gender)
- **å¹´é½¡**: customer.virtualAge + "æ­²"
- **è¾²æ›†å‡ºç”Ÿ**: æ°‘åœ‹XXå¹´XæœˆXæ—¥æ ¼å¼
- **åœ°å€**: customer.addresses[0].address
- **é›»è©±**: customer.phone
- **ç·¨è™Ÿ**: customer.queueNumber
- **è«‹ç¤ºå…§å®¹**: è«®è©¢ä¸»é¡Œä¸­æ–‡åŒ–

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹è¦åŠƒ

### æ–°å¢/ä¿®æ”¹æª”æ¡ˆæ¸…å–®
```
frontend/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ExportDialog.jsx (ä¿®æ”¹)
â”‚   â””â”€â”€ admin/
â”‚       â”œâ”€â”€ ExcelPreviewTable.jsx (æ–°å¢)
â”‚       â””â”€â”€ FormTemplate.jsx (æ–°å¢)
â”œâ”€â”€ pages/admin/
â”‚   â”œâ”€â”€ ExcelPreviewPage.jsx (æ–°å¢)
â”‚   â””â”€â”€ PDFPreviewPage.jsx (æ–°å¢)
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ exportUtils.js (ä¿®æ”¹)
â”‚   â””â”€â”€ pdfGenerator.js (æ–°å¢)
â””â”€â”€ App.js (ä¿®æ”¹ - æ–°å¢è·¯ç”±)
```

### æŠ€è¡“å¥—ä»¶éœ€æ±‚
```bash
npm install jspdf html2canvas
```

## ğŸ“ é–‹ç™¼æª¢æŸ¥æ¸…å–®

### Phase 1: åŸºç¤æ¶æ§‹
- [ ] ä¿®æ”¹ ExportDialog.jsx æ–°å¢å…©å€‹é¸é …
- [ ] æ–°å¢é è¦½é é¢è·¯ç”±çµæ§‹
- [ ] å¯¦ä½œæ–°é–‹ç¶²é é‚è¼¯

### Phase 2: Excel åŠŸèƒ½
- [ ] å¯¦ä½œè³‡æ–™ç¯©é¸é‚è¼¯ (waiting + processing)
- [ ] å¯¦ä½œåˆä½µå„²å­˜æ ¼é‚è¼¯
- [ ] å»ºç«‹ Excel é è¦½é é¢
- [ ] æ¸¬è©¦è¾²æ›†æ—¥æœŸæ ¼å¼åŒ–
- [ ] æ¸¬è©¦äººæ•¸è¨ˆç®—é‚è¼¯

### Phase 3: PDF åŠŸèƒ½
- [ ] è¨­è¨ˆå•äº‹å–® HTML æ¨¡æ¿
- [ ] å¯¦ä½œ A4 æ©«å¼ + é›™ A5 ç›´å¼ä½ˆå±€
- [ ] å»ºç«‹ PDF é è¦½é é¢
- [ ] æ¸¬è©¦ PDF ç”Ÿæˆé‚è¼¯
- [ ] é©—è­‰åˆ—å°æ•ˆæœ

### Phase 4: æ•´åˆæ¸¬è©¦
- [ ] å®Œæ•´æ“ä½œæµç¨‹æ¸¬è©¦
- [ ] é è¦½åŠŸèƒ½æ¸¬è©¦
- [ ] ä¸‹è¼‰åŠŸèƒ½æ¸¬è©¦
- [ ] è·¨ç€è¦½å™¨å…¼å®¹æ€§æ¸¬è©¦

## âš ï¸ é—œéµæŠ€è¡“é‡é»

### Excel åˆä½µå„²å­˜æ ¼å¯¦ä½œ
ä½¿ç”¨ XLSX åº«çš„ `!merges` å±¬æ€§ï¼š
```javascript
const merges = [];
let currentRow = 1; // å¾ç¬¬äºŒè¡Œé–‹å§‹ (ç¬¬ä¸€è¡Œæ˜¯æ¨™é¡Œ)

customers.forEach(customer => {
  const familySize = 1 + customer.familyMembers.length;
  const endRow = currentRow + familySize - 1;
  
  // åˆä½µéœ€è¦åˆä½µçš„æ¬„ä½
  merges.push(
    { s: { r: currentRow, c: 0 }, e: { r: endRow, c: 0 } }, // å®Œæˆ
    { s: { r: currentRow, c: 1 }, e: { r: endRow, c: 1 } }, // åºè™Ÿ
    { s: { r: currentRow, c: 3 }, e: { r: endRow, c: 3 } }, // äººæ•¸
    { s: { r: currentRow, c: 9 }, e: { r: endRow, c: 9 } }, // è«®è©¢ä¸»é¡Œ
    { s: { r: currentRow, c: 10 }, e: { r: endRow, c: 10 } } // å‚™è¨»
  );
  
  currentRow += familySize;
});

ws['!merges'] = merges;
```

### PDF ä½ˆå±€å¯¦ä½œ
```css
.pdf-container {
  width: 297mm;
  height: 210mm;
  display: flex;
  flex-direction: row;
  background: white;
}

.form-left, .form-right {
  width: 147.5mm;
  height: 210mm;
  border: 1px solid black;
}

.cut-line {
  width: 2mm;
  height: 210mm;
  border-left: 1px dashed #999;
  margin: 0 1mm;
}
```

## ğŸš€ é–‹ç™¼é †åº

1. **åŸºç¤æ¡†æ¶** - ä¿®æ”¹å°è©±æ¡†å’Œè·¯ç”±
2. **Excel åŠŸèƒ½** - å¯¦ä½œåˆä½µé‚è¼¯å’Œé è¦½
3. **PDF åŠŸèƒ½** - å¯¦ä½œæ¨¡æ¿å’Œç”Ÿæˆ
4. **æ•´åˆæ¸¬è©¦** - å®Œæ•´æµç¨‹é©—è­‰

---

**é–‹ç™¼æ™‚è«‹åš´æ ¼éµå¾ªæ­¤è¦åŠƒæ–‡æª”ï¼Œç¢ºä¿æ¯å€‹éšæ®µå®Œæˆå¾Œé€²è¡Œå……åˆ†æ¸¬è©¦ï¼**
